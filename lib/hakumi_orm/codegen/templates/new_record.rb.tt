# typed: strict
# frozen_string_literal: true
# GENERATED BY hakumi-orm -- DO NOT EDIT

<%- if module_name -%>
module <%= module_name %>
<%- end -%>
<%= ind %>class <%= record_class_name %>
<%= ind %>  class New
<%= ind %>    extend T::Sig
<%= ind %>    include <%= record_class_name %>::Checkable

<%- columns.each do |col| -%>
<%= ind %>    sig { override.returns(<%= col[:ruby_type] %>) }
<%= ind %>    attr_reader :<%= col[:name] %>

<%- end -%>
<%= ind %>    sig { params(<%= init_sig_params %>).void }
<%= ind %>    def initialize(<%= init_args %>)
<%- columns.each do |col| -%>
<%= ind %>      @<%= col[:name] %> = T.let(<%= col[:name] %>, <%= col[:ruby_type] %>)
<%- end -%>
<%= ind %>    end

<%= ind %>    sig { returns(<%= record_class_name %>::Validated) }
<%= ind %>    def validate!
<%= ind %>      errors = ::HakumiORM::Errors.new
<%= ind %>      <%= record_class_name %>::Contract.on_all(self, errors)
<%= ind %>      <%= record_class_name %>::Contract.on_create(self, errors)
<%= ind %>      raise ::HakumiORM::ValidationError, errors unless errors.valid?

<%= ind %>      <%= record_class_name %>::Validated.new(self)
<%= ind %>    end
<%= ind %>  end
<%= ind %>end
<%- if module_name -%>
end
<%- end -%>
